
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <script src="assets/js/node_modules/jscoq/frontend/classic/js/jscoq-agent.js" type="module"></script>
<link href="assets/js/node_modules/jscoq/frontend/classic/css/jscoqdoc.css" rel="stylesheet" type="text/css" />
  <title>DependentPatternMatching.v</title>
</head>
<body>
<div id="page">
<div id="header"></div>
<div id="main" class="jscoqdoc">
<h1 class="libtitle">Library DependentPatternMatching</h1>

<div class="code">
<span class="id" title="keyword">Module</span> <span class="id" title="var">DestructuringLet</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">prod</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pair</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <span class="id" title="var">pair</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="tactic">assert</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">fst</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">prod</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">A</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">pair</span> <span class="id" title="var">a</span> <span class="id" title="var">_</span> := <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_sym_refl</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">y</span> = <span class="id" title="var">x</span> := <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_sym_eq_rect</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">y</span> = <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_rect</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x'</span> =&gt; <span class="id" title="var">x'</span> = <span class="id" title="var">x</span>) <span class="id" title="var">eq_refl</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Print</span> <span class="id" title="var">eq_rect</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_sym_match</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">y</span> = <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eq_refl</span> =&gt; <span class="id" title="var">eq_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_sym_destruct</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">y</span> = <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_sym_let</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">y</span> = <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_sym_let2</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">y</span> = <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> : <span class="id" title="var">y</span> = <span class="id" title="var">x</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">DestructuringLet</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">BinaryWordV1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">binary_word</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">bw1</span> (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) : <span class="id" title="var">binary_word</span> 1<br/>
&nbsp;&nbsp;| <span class="id" title="var">bwn</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_concat</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">w1</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">binary_word</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">bwn</span> <span class="id" title="var">b</span> <span class="id" title="var">w2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">b</span> <span class="id" title="var">w</span> =&gt; <span class="id" title="var">bwn</span> <span class="id" title="var">b</span> (<span class="id" title="var">binary_word_concat</span> <span class="id" title="var">w</span> <span class="id" title="var">w2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w1</span>, <span class="id" title="var">w2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, <span class="id" title="var">bwn</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w1</span>, <span class="id" title="var">w2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, <span class="id" title="var">bwn</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span>, <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">n1'</span> = <span class="id" title="var">n2'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span>, <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">n1'</span> = <span class="id" title="var">n2'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pw2'</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n1</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span>, <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">n1'</span> = <span class="id" title="var">n2'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="keyword">fun</span> (<span class="id" title="var">e</span> : <span class="id" title="var">S</span> <span class="id" title="var">n1</span> = <span class="id" title="var">S</span> <span class="id" title="var">n2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> : <span class="id" title="var">n1</span> = <span class="id" title="var">n2</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pw2'</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n1</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or_pre</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span>, <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">n1'</span> = <span class="id" title="var">n2'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="keyword">fun</span> (<span class="id" title="var">e</span> : <span class="id" title="var">S</span> <span class="id" title="var">n1</span> = <span class="id" title="var">S</span> <span class="id" title="var">n2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> : <span class="id" title="var">n2</span> = <span class="id" title="var">n1</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pw2'</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n1</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or_pre</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or_good</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span>, <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">n1'</span> = <span class="id" title="var">n2'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pw2'</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n1</span> := <span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">eq_sym</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or_good</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">discriminate_bwn_SO_n</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; 1 = <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> <span class="id" title="var">w2</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span> | <span class="id" title="var">b</span> <span class="id" title="var">n</span> <span class="id" title="var">w</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> **; [<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span>, <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">n2'</span> = <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">_</span>, <span class="id" title="var">bwn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n</span> <span class="id" title="var">bw</span> <span class="id" title="var">I</span> (<span class="id" title="var">eq_sym</span> <span class="id" title="var">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n</span> <span class="id" title="var">bw</span> <span class="id" title="var">I</span> <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">binary_word_or_lemma</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>), <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="var">F</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b1</span>|<span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">remember</span> 1 <span class="id" title="keyword">as</span> <span class="id" title="var">x</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">w2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">w2'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ew2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b2</span>|<span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Ex</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Ex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">n2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">pw2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">remember</span> (<span class="id" title="var">S</span> <span class="id" title="var">n1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">x</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b2</span>|<span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">bw1</span> <span class="id" title="var">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Ex</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Ex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Ex</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">F</span> <span class="id" title="var">_</span> <span class="id" title="var">pw1</span> <span class="id" title="var">pw2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">discriminate_bwn_SO_n'</span> {<span class="id" title="var">n</span> <span class="id" title="var">b</span> <span class="id" title="var">pw</span>} (<span class="id" title="var">w</span> : <span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">w</span> = <span class="id" title="var">bwn</span> <span class="id" title="var">b</span> <span class="id" title="var">pw</span> -&gt; 1 = <span class="id" title="var">S</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">pw</span>; <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or'</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span>, <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">n2'</span> = <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span>, <span class="id" title="var">bwn</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or'</span> <span class="id" title="var">pw1</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">_</span>, <span class="id" title="var">bwn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n'</span> <span class="id" title="var">bw</span> <span class="id" title="var">eq_refl</span> (<span class="id" title="var">eq_sym</span> <span class="id" title="var">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span>, <span class="id" title="var">bw1</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n'</span> <span class="id" title="var">bw</span> <span class="id" title="var">eq_refl</span> <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or1</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">n1'</span> = <span class="id" title="var">n</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">w2</span> <span class="id" title="var">e0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">return</span> <span class="id" title="var">n</span> = <span class="id" title="var">n2'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n</span> <span class="id" title="var">bw</span> <span class="id" title="var">I</span> (<span class="id" title="var">eq_trans</span> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">w2</span> <span class="id" title="var">e0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">return</span> <span class="id" title="var">n2'</span> = <span class="id" title="var">n</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n</span> <span class="id" title="var">bw</span> <span class="id" title="var">I</span> (<span class="id" title="var">eq_trans</span> <span class="id" title="var">e1</span> (<span class="id" title="var">eq_sym</span> <span class="id" title="var">e0</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> : <span class="id" title="var">S</span> <span class="id" title="var">n2</span> = <span class="id" title="var">S</span> <span class="id" title="var">n1</span> := <span class="id" title="var">eq_trans</span> <span class="id" title="var">e1</span> (<span class="id" title="var">eq_sym</span> <span class="id" title="var">e0</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">eq_sym</span> <span class="id" title="var">e'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">w2</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or2</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">n1'</span> = <span class="id" title="var">n</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">w2</span> <span class="id" title="var">e0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">return</span> 1 = <span class="id" title="var">n2'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n</span> <span class="id" title="var">bw</span> <span class="id" title="var">I</span> <span class="id" title="var">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">w2</span> <span class="id" title="var">e0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">return</span> <span class="id" title="var">n2'</span> = <span class="id" title="var">S</span> <span class="id" title="var">n1</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n2'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False_rect</span> <span class="id" title="var">_</span> (<span class="id" title="var">discriminate_bwn_SO_n</span> <span class="id" title="var">bw</span> <span class="id" title="var">I</span> <span class="id" title="var">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">bw</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">e1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">eq_sym</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_refl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">w2</span> <span class="id" title="var">eq_refl</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">BinaryWordV1</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">CoqArt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">binary_word</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">bw0</span> :  <span class="id" title="var">binary_word</span> 0<br/>
&nbsp;&nbsp;| <span class="id" title="var">bwS</span> (<span class="id" title="var">p</span> : <span class="id" title="var">nat</span>)(<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>)(<span class="id" title="var">w</span>: <span class="id" title="var">binary_word</span> <span class="id" title="var">p</span>) : <span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">p</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">discriminate_O_S</span> {<span class="id" title="var">p</span>:<span class="id" title="var">nat</span>}:  0 = <span class="id" title="var">S</span> <span class="id" title="var">p</span> -&gt; <span class="id" title="var">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span>  <span class="id" title="var">discriminate_S_O</span> {<span class="id" title="var">p</span>:<span class="id" title="var">nat</span>}:  <span class="id" title="var">S</span> <span class="id" title="var">p</span> = 0 -&gt; <span class="id" title="var">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>)(<span class="id" title="var">w1</span>:<span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">w1</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">p</span> <span class="id" title="keyword">return</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">p</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bw0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">w2</span>:<span class="id" title="var">binary_word</span> 0 =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">p'</span> <span class="id" title="keyword">return</span> <span class="id" title="var">p'</span>=0-&gt;<span class="id" title="var">binary_word</span> <span class="id" title="var">p'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bw0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">bw0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwS</span> <span class="id" title="var">q</span> <span class="id" title="var">b</span> <span class="id" title="var">w2'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">False_rec</span> (<span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">q</span>)) (<span class="id" title="var">discriminate_S_O</span> <span class="id" title="var">h</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> (<span class="id" title="var">refl_equal</span> 0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwS</span> <span class="id" title="var">q</span> <span class="id" title="var">b1</span> <span class="id" title="var">w1'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">w2</span>:<span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">p'</span> <span class="id" title="keyword">return</span> <span class="id" title="var">S</span> <span class="id" title="var">q</span>=<span class="id" title="var">p'</span>-&gt;<span class="id" title="var">binary_word</span> <span class="id" title="var">p'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bw0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">False_rec</span> (<span class="id" title="var">binary_word</span> 0) (<span class="id" title="var">discriminate_S_O</span> <span class="id" title="var">h</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwS</span> <span class="id" title="var">q'</span> <span class="id" title="var">b2</span> <span class="id" title="var">w2'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwS</span> <span class="id" title="var">q'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">orb</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">binary_word_or</span> <span class="id" title="var">q'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eq_rec</span> (<span class="id" title="var">S</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">v</span>:<span class="id" title="var">nat</span> =&gt; <span class="id" title="var">binary_word</span> (<span class="id" title="var">pred</span> <span class="id" title="var">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">S</span> <span class="id" title="var">q'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span>:<span class="id" title="var">S</span> <span class="id" title="var">q</span>=<span class="id" title="var">S</span> <span class="id" title="var">q'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w2'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> (<span class="id" title="var">refl_equal</span> (<span class="id" title="var">S</span> <span class="id" title="var">q</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or'</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">n1'</span> = <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw0</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwS</span> <span class="id" title="var">p1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span> =&gt; <span class="id" title="keyword">fun</span> '(<span class="id" title="var">bwS</span> <span class="id" title="var">p2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">S</span> <span class="id" title="var">p2</span> = <span class="id" title="var">S</span> <span class="id" title="var">p1</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwS</span> <span class="id" title="var">_</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or'</span> <span class="id" title="var">pw1</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">w2</span> <span class="id" title="var">eq_refl</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">CoqArt</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">listn</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Set</span> :=<br/>
| <span class="id" title="var">niln</span> : <span class="id" title="var">listn</span> 0<br/>
| <span class="id" title="var">consn</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>:<span class="id" title="var">nat</span>, <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">listn</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">listn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">tail</span> <span class="id" title="var">n</span> (<span class="id" title="var">v</span>: <span class="id" title="var">listn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">v</span> <span class="id" title="tactic">in</span> <span class="id" title="var">listn</span> (<span class="id" title="var">S</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">return</span> <span class="id" title="var">listn</span> <span class="id" title="var">m</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">niln</span> =&gt; <span class="id" title="var">False_rect</span> <span class="id" title="var">unit</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">consn</span> <span class="id" title="var">n'</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">BinaryWord2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">binary_word</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">bw1</span> (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) : <span class="id" title="var">binary_word</span> 1<br/>
&nbsp;&nbsp;| <span class="id" title="var">bwn</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) : <span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_or</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">return</span> <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">n1'</span> = <span class="id" title="var">n1'</span> -&gt; <span class="id" title="var">binary_word</span> <span class="id" title="var">n1'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> '(<span class="id" title="var">bw1</span> <span class="id" title="var">b2</span>) <span class="id" title="var">_</span> =&gt; <span class="id" title="var">bw1</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n1</span> <span class="id" title="var">b1</span> <span class="id" title="var">pw1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> '(@<span class="id" title="var">bwn</span> <span class="id" title="var">n2</span> <span class="id" title="var">b2</span> <span class="id" title="var">pw2</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n2</span>) = <span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n1</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bwn</span> (<span class="id" title="var">b1</span> || <span class="id" title="var">b2</span>) (<span class="id" title="var">binary_word_or</span> <span class="id" title="var">pw1</span> (<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pw2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="var">w2</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">to_S</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">w</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) : {<span class="id" title="var">n'</span> &amp; <span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">n'</span>) &amp; <span class="id" title="var">S</span> <span class="id" title="var">n'</span> = <span class="id" title="var">n</span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b'</span> =&gt; <span class="id" title="var">existT2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 (<span class="id" title="var">bw1</span> <span class="id" title="var">b'</span>) <span class="id" title="var">eq_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">bwn</span> <span class="id" title="var">n'</span> <span class="id" title="var">b'</span> <span class="id" title="var">w'</span> =&gt; <span class="id" title="var">existT2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">S</span> <span class="id" title="var">n'</span>) (<span class="id" title="var">bwn</span> <span class="id" title="var">b'</span> <span class="id" title="var">w'</span>) <span class="id" title="var">eq_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">binary_word_concat</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">w1</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w2</span> : <span class="id" title="var">binary_word</span> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">binary_word</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bw1</span> <span class="id" title="var">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t3</span> : {<span class="id" title="var">m'</span> &amp; <span class="id" title="var">binary_word</span> (<span class="id" title="var">S</span> <span class="id" title="var">m'</span>) &amp; <span class="id" title="var">S</span> <span class="id" title="var">m'</span> = <span class="id" title="var">m</span>} := <span class="id" title="var">to_S</span> <span class="id" title="var">w2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">w2'</span> := <span class="id" title="var">projT2</span> (<span class="id" title="var">sigT_of_sigT2</span> <span class="id" title="var">t3</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<span class="id" title="var">eq_refl</span> := <span class="id" title="var">projT3</span> <span class="id" title="var">t3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">bwn</span> <span class="id" title="var">b</span> <span class="id" title="var">w2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bwn</span> <span class="id" title="var">b</span> <span class="id" title="var">w</span> =&gt; <span class="id" title="var">bwn</span> <span class="id" title="var">b</span> (<span class="id" title="var">binary_word_concat</span> <span class="id" title="var">w</span> <span class="id" title="var">w2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">BinaryWord2</span>.<br/>
</div>

</div>
</div>
</body>
</html>
